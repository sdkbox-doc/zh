<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Apteligent with C++ - SDKBOX</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/custom.css" rel="stylesheet">


        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-70044300-2', 'auto');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://sdkbox.com"><img src="http://www.cocos2d-x.org/s/sdkbox/SDKBOX_logo.png"></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Overview</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cocos <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cocos/">Cocos Integration</a>
</li>

                        
                            
<li >
    <a href="../../../installer/">Installer</a>
</li>

                        
                            
  
  <li class="dropdown-submenu">
    <a tabindex="-1" class="non-link">Plugins</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../achievement/">Achievements</a>
</li>

        
            
  

        
            
<li >
    <a href="../../adcolony/">AdColony</a>
</li>

        
            
  

        
            
<li >
    <a href="../../admob/">AdMob</a>
</li>

        
            
  

        
            
<li >
    <a href="../../agecheq/">AgeCheq</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appnext/">Appnext</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appodeal/">Appodeal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../amazon/">Amazon</a>
</li>

        
            
  

        
            
<li >
    <a href="../">Apteligent</a>
</li>

        
            
  

        
            
<li >
    <a href="../../bee7/">Bee7</a>
</li>

        
            
  

        
            
<li >
    <a href="../../chartboost/">Chartboost</a>
</li>

        
            
  

        
            
<li >
    <a href="../../facebook/">Facebook</a>
</li>

        
            
  

        
            
<li >
    <a href="../../flurryanalytics/">Flurry Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../fyber/">Fyber</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleanalytics/">Google Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../iap/">In-App Purchase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../inmobi/">InMobi</a>
</li>

        
            
  

        
            
<li >
    <a href="../../kochava/">Kochava</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leadbolt/">LeadBolt</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leaderboard/">Leaderboard</a>
</li>

        
            
  

        
            
<li >
    <a href="../../playphone/">Playphone</a>
</li>

        
            
  

        
            
<li >
    <a href="../../review/">Ratings & Reviews</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxads/">SDKBOX Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxplay/">SDKBOX Play</a>
</li>

        
            
  

        
            
<li >
    <a href="../../share/">Social Sharing</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tune/">Tune</a>
</li>

        
            
  

        
            
<li >
    <a href="../../valuepotion/">Valuepotion</a>
</li>

        
            
  

        
            
<li >
    <a href="../../vungle/">Vungle</a>
</li>

        
            
  

        
            
<li >
    <a href="../../youtube/">Youtube</a>
</li>

        
            
  

        
    </ul>
  </li>
  

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unity <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unity/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unity/review/">Ratings & Reviews</a>
</li>

                        
                            
<li >
    <a href="../../../unity/socialshare/">SocialShare</a>
</li>

                        
                            
<li >
    <a href="../../../unity/googleanalytics/documentation/">Google Analytics</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unreal <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unreal/iap/">In-App Purchase</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CocosCreator <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../qa/integration-admob-to-creator/">集成指南</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">LiveOps <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../liveops/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/remote-config/">Remote Configuration</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/receipt-verification/">Server-side IAP receipt verification</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/catalog-management/">On-the-fly catalog management</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Q&A <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../qa/installgoogleplaystore/">GooglePlay安装指南</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-admob-to-creator/">CocosCreator集成指南</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../release-note/">About</a>
                    </li>
                
                

                    <!-- new add for language button -->
                    <li>
                        <a href="http://sdkbox-doc.github.io/en/">English</a>
                    </li>
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li >
                        <a rel="next" href="../v3-lua/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../v2-js/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1">集成</a></li>
        
    
        <li class="main "><a href="#china">从 China 服务器下载</a></li>
        
    
        <li class="main "><a href="#_2">重点注意事项</a></li>
        
            <li><a href="#_3">禁用应用程序安全传输策略</a></li>
        
            <li><a href="#bitcode">禁止 Bitcode 支持</a></li>
        
            <li><a href="#_4">游戏全屏配置</a></li>
        
            <li><a href="#canopenurl">canOpenURL 白名单</a></li>
        
            <li><a href="#json">JSON 配置</a></li>
        
    
        <li class="main "><a href="#_6">使用</a></li>
        
            <li><a href="#apteligent">初始化 Apteligent</a></li>
        
            <li><a href="#breadcrumbs">注册追踪器 Breadcrumbs</a></li>
        
            <li><a href="#_7">注册用户元数据</a></li>
        
            <li><a href="#_8">注册用户流</a></li>
        
            <li><a href="#_9">修改用户流的值</a></li>
        
            <li><a href="#_10">注册网络请求</a></li>
        
            <li><a href="#_11">过滤截获数据</a></li>
        
            <li><a href="#_12">配置位置坐标</a></li>
        
            <li><a href="#_13">其他任务</a></li>
        
            <li><a href="#apteligentlistener">实现 ApteligentListener</a></li>
        
    
        <li class="main "><a href="#api-reference">API Reference</a></li>
        
            <li><a href="#methods">Methods</a></li>
        
            <li><a href="#listeners">Listeners</a></li>
        
    
        <li class="main "><a href="#_14">手动集成</a></li>
        
    
        <li class="main "><a href="#ios">iOS 平台手动集成</a></li>
        
    
        <li class="main "><a href="#android">Android 手动集成</a></li>
        
            <li><a href="#_15">拷贝文件</a></li>
        
            <li><a href="#androidmanifestxml">编辑 AndroidManifest.xml</a></li>
        
            <li><a href="#androidmk">编辑 Android.mk</a></li>
        
            <li><a href="#applicationmk">编辑 Application.mk</a></li>
        
            <li><a href="#yourgamenamejava">修改 &lt;YourGameName&gt;.java</a></li>
        
    
        <li class="main "><a href="#proguard-release">使用 Proguard （release模式下可选）</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../">&#8249; Apteligent Doc Home</a></p>
<h1>Apteligent 集成指南</h1>

<h4><em><b>For the C++ version of cocos2d-x v2.x</b> - (<a href="./../">all other versions</a>)</em></h4>

<h2 id="_1">集成</h2>
<p>注册一个 <a href="https://www.apteligent.com/">Apteligent</a> 帐号并且创建一个 app 。</p>
<p>在您确保正确安装了 SDKBOX installer 的情况下，运行下面的命令来集成 SDKBOX Apteligent 插件。</p>
<pre><code class="bash">$ sdkbox import apteligent
</code></pre>

<h2 id="china">从 China 服务器下载</h2>
<p>如果你在中国, 并且下载插件的速度比较慢, 可以尝试使用位于中国的服务器来下载, 查询插件, 使用方法为在你的 <code>sdkbox import</code> 后加 <code>--server china</code> 及可, 比如:</p>
<pre><code class="bash">sdkbox import xxx  --server china
</code></pre>

<p>xxx 为你的插件名字</p>
<h2 id="_2">重点注意事项</h2>
<p>如果您升级到了 Xcode7, 则需要以下额外步骤来确保插件工作正常:</p>
<h4 id="_3">禁用应用程序安全传输策略</h4>
<p>添加以下项到 plist:</p>
<pre><code>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
</code></pre>

<p>添加后的文件内容看起来就像这样：</p>
<p><img alt="" src="../../../imgs/ATS.png" /></p>
<h4 id="bitcode">禁止 Bitcode 支持</h4>
<p>您必须禁止 <strong>Bitcode</strong> 的支持，否则将会编译失败。</p>
<h4 id="_4">游戏全屏配置</h4>
<p>如果您的游戏不同时支持横竖屏，则必须在 Xcode 中选中 <code>Requires full screen</code>，否则将不会通过 Apple 的审核。</p>
<h4 id="canopenurl">canOpenURL 白名单</h4>
<p>取决于您使用哪些插件。需要在 <code>info.plist</code> 的 <code>LSApplicationQueriesSchemes</code> 下添加名单。</p>
<!--## Configuration
### SDKBOX Cloud
SDKBOX Cloud enables developers to receive the benefits of a centralized application management interface, by helping to boost their applications with extended functionality. The two main features are: __Remote Application Management__ which provides the abilities of updating and testing, and __IAP Receipt Verification__.

Developers must register at Chukong’s website to get __developers credentials__. After receiving __developers credentials__, developers can register an unlimited number of __applications__. Each __application__ will have an associated __application token__ and a __application secret__. These are used to securely transmit new plugin configurations to the clients as well as grant access to all the remotely accessible services.

### Remote Application Configuration
SDKBOX allows developers to create a __Remote Application Configuration__ for each application they are developing.

Registering the applications’ allows for on-the-fly update of its plugin’s configuration. For example, it will allow the change of the Google Analytics tracking code, switch to a new AdColony campaign or add new in-app purchase products without rebuilding and redeploying your apps to the app stores.

To enable this cloud service in your applications is as easy as calling a single __init()__ function and passing in your __application token__ and __application secret__ that were provided when you created the app in the previous section.

wzxhzdk:3

  __Note__: each application will have it’s own __application token__ and each configuration for each game will have it’s own __application secret__. The __application secret__ is the actual encryption key used to decipher the remote configuration.

When the developer updates a __Remote Application Configuration__ the application will automatically pull the new configuration and put it into effect. This means that you can update configuration information on the fly and everyone playing your game will get updated the next time the user starts the application!

To ensure security, during normal execution the new configuration is locally saved in the applications’s private folder, and the next time it restarts it is applied. Also, configurations are cyphered and its contents are not exposed, even if your application runs on a rooted/jailbroken device.
-->

<h3 id="json">JSON 配置</h3>
<p>SDKBOX Installer 将会自动在您的 <code>sdkbox_config.json</code> 中插入一份配置样例。请修改这份配置样例，使其能用于您自己的 app 。</p>
<ul>
<li>id: Apteligent App ID</li>
</ul>
<h4 id="_5">可选项</h4>
<hr />
<ul>
<li>
<p>monitor_connection [bool]: (iOS only)</p>
<ul>
<li>true [default]</li>
<li>false</li>
</ul>
</li>
</ul>
<blockquote>
<p>Determines whether Service Monitoring should capture network performance information for network calls made through NSURLConnection.</p>
</blockquote>
<ul>
<li>
<p>monitor_session [bool]: (iOS only)</p>
<ul>
<li>true [default]</li>
<li>false</li>
</ul>
</li>
</ul>
<blockquote>
<p>Determines whether Service Monitoring should capture network performance information for network calls made through NSURLSession.</p>
</blockquote>
<ul>
<li>
<p>enable_service_monitoring [bool]:</p>
<ul>
<li>true [default]</li>
<li>false</li>
</ul>
</li>
</ul>
<blockquote>
<p>This flag determines wither Apteligent service monitoring is enabled at all.</p>
</blockquote>
<ul>
<li>
<p>delay_sending_appload [bool]:</p>
<ul>
<li>true</li>
<li>false [default]</li>
</ul>
</li>
</ul>
<blockquote>
<p>Delay to reports an app load event.</p>
</blockquote>
<ul>
<li>
<p>url_filters [array]:</p>
<ul>
<li>["http://www.gmail.com", "www.other.com"]</li>
</ul>
</li>
</ul>
<blockquote>
<p>These filters are used to make it so certain network performance information is not reported to Apteligent.</p>
</blockquote>
<ul>
<li>
<p>logcat_reporting_enabled: (Android only) Include Logcat</p>
<ul>
<li>true</li>
<li>false [default]</li>
</ul>
</li>
</ul>
<blockquote>
<p>Including system log data (Logcat) can be helpful for debugging crashes and handled exceptions,
but it comes at the cost of slightly increasing disk and network usage, which is why this feature
must be manually enabled. Apteligent collects the last 100 lines of logcat data.</p>
</blockquote>
<p>more information:</p>
<ul>
<li><a href="https://docs.crittercism.com/ios/ios.html">https://docs.crittercism.com/ios/ios.html</a></li>
<li><a href="https://docs.crittercism.com/android/android.html">https://docs.crittercism.com/android/android.html</a></li>
</ul>
<p>Example:</p>
<pre><code class="json">{
    &quot;ios&quot;: {
        &quot;Apteligent&quot;:{
            &quot;debug&quot;:true,
            &quot;id&quot;:&quot;956194d922984692a3184816ec3a510300555300&quot;,
            &quot;monitor_connection&quot;:true,
            &quot;monitor_session&quot;:true,
            &quot;enable_service_monitoring&quot;:true,
            &quot;delay_sending_appload&quot;:false,
            &quot;url_filters&quot;:[
                &quot;https://metrics.sdkbox.com&quot;,
                &quot;http://www.gmail.com&quot;
            ]
        }
    },
    &quot;android&quot;: {
        &quot;Apteligent&quot;:{
            &quot;debug&quot;:true,
            &quot;id&quot;:&quot;3f66168979494ce38374b4d32d637dcc00555300&quot;,
            &quot;enable_service_monitoring&quot;:true,
            &quot;delay_sending_appload&quot;:false,
            &quot;url_filters&quot;:[
                &quot;https://metrics.sdkbox.com&quot;,
                &quot;http://www.gmail.com&quot;
            ],
            &quot;version&quot;:&quot;version:2.0.4 build:4981 codeName:Cactus&quot;,
            &quot;version_string_include_version_code&quot;:true,
            &quot;logcat_reporting_enabled&quot;:true
        }
    }
}

</code></pre>

<h2 id="_6">使用</h2>
<h3 id="apteligent">初始化 Apteligent</h3>
<p>在您的代码的合适的位置初始化这个插件，我们建议您在 <code>AppDelegate:applicationDidFinishLaunching()</code> 或者 <code>AppController:didFinishLaunchingWithOptions()</code> 中进行初始化。并确保您的代码中包含了正确的头文件。举例如下：</p>
<pre><code class="cpp">#include &quot;PluginApteligent/PluginApteligent.h&quot;
AppDelegate::applicationDidFinishLaunching()
{
     sdkbox::PluginApteligent::init();
}
</code></pre>

<h3 id="breadcrumbs">注册追踪器 Breadcrumbs</h3>
<pre><code class="cpp">// leave a breadcrumb
sdkbox::PluginApteligent::leaveBreadcrumb(&quot;User tapped start button&quot;);

// perform all breadcrumb writes on a background thread
sdkbox::PluginApteligent::setAsyncBreadcrumbMode(true);
</code></pre>

<h3 id="_7">注册用户元数据</h3>
<pre><code>// Adding a Username
sdkbox::PluginApteligent::setUsername(&quot;MrsCritter&quot;);

// Adding Arbitrary User Metadata
sdkbox::PluginApteligent::setValueforKey(&quot;5&quot;, &quot;Game Level&quot;);
</code></pre>

<h3 id="_8">注册用户流</h3>
<pre><code class="cpp">// Beginning a Userflow
sdkbox::PluginApteligent::beginUserflow(&quot;login&quot;);

// Ending a Userflow
sdkbox::PluginApteligent::endUserflow(&quot;login&quot;);

// Failing a Userflow
sdkbox::PluginApteligent::failUserflow(&quot;login&quot;);

// Cancelling a Userflow
sdkbox::PluginApteligent::cancelUserflow(&quot;login&quot;);
</code></pre>

<h3 id="_9">修改用户流的值</h3>
<pre><code class="cpp">int valueInCents = sdkbox::PluginApteligent::valueForUserflow(&quot;my_userflow&quot;);
valueInCents += 5;
sdkbox::PluginApteligent::setValueforUserflow(valueInCents, &quot;my_userflow&quot;);

</code></pre>

<h3 id="_10">注册网络请求</h3>
<pre><code class="cpp">sdkbox::PluginApteligent::logNetworkRequest(&quot;GET&quot;, &quot;http://www.abc123def456.com&quot;, 2.0, 1000, 100, 200);
</code></pre>

<h3 id="_11">过滤截获数据</h3>
<pre><code class="cpp">sdkbox::PluginApteligent::addFilter(&quot;www.gmail.com&quot;);
</code></pre>

<h3 id="_12">配置位置坐标</h3>
<pre><code class="cpp">// Beijing, China
sdkbox::PluginApteligent::updateLocation(39.9042, 116.4074);
</code></pre>

<h3 id="_13">其他任务</h3>
<pre><code class="cpp">// Allowing Users to Opt Out of Apteligent
sdkbox::PluginApteligent::setOptOutStatus(true);

// Changing the verbosity of Apteligent’s Logs
// sdkbox::CRLoggingLevelSilent  : Turns off all Apteligent log messages
// sdkbox::CRLoggingLevelError   : Only print errors. An error is an unexpected event that will result not capturing important data
// sdkbox::CRLoggingLevelWarning : (Default) Only print warnings. Currently warning messages are printed when calling Apteligent methods before initializing Apteligent.
// sdkbox::CRLoggingLevelInfo    : The most verbose level of logging
sdkbox::PluginApteligent::setLoggingLevel(sdkbox::CRLoggingLevelInfo);

// Send App Load Data
// You must set `&quot;delay_sending_appload&quot;:true` in `sdkbox_config.json` first
sdkbox::PluginApteligent::sendAppLoadData();
</code></pre>

<h3 id="apteligentlistener">实现 ApteligentListener</h3>
<ul>
<li>您可以实现 ApteligentListener 用来设置回调，比如当一个视频播放完成的时候。</li>
</ul>
<pre><code class="cpp">#include &quot;PluginApteligent/PluginApteligent.h&quot;
class MyClass : public sdkbox::ApteligentListener
{
private:
    void onCrashOnLastLoad() {} // not support on android
}
</code></pre>

<h2 id="api-reference">API Reference</h2>
<h3 id="methods">Methods</h3>
<pre><code class="cpp">static bool init ( ) ;
</code></pre>

<blockquote>
<p>initialize the plugin instance.</p>
</blockquote>
<pre><code class="cpp">static void setListener ( ApteligentListener * listener ) ;
</code></pre>

<blockquote>
<p>Set listener to listen for apteligent events</p>
</blockquote>
<pre><code class="cpp">static ApteligentListener * getListener ( ) ;
</code></pre>

<blockquote>
<p>Get the listener</p>
</blockquote>
<pre><code class="cpp">static void removeListener ( ) ;
</code></pre>

<blockquote>
<p>Remove the listener, and can't listen to events anymore</p>
</blockquote>
<pre><code class="cpp">static void addFilter ( const std::string &amp; filter ) ;
</code></pre>

<blockquote>
<p>Adds an additional filter for network instrumentation.</p>
</blockquote>
<pre><code class="cpp">static void leaveBreadcrumb ( const std::string &amp; breadcrumb ) ;
</code></pre>

<blockquote>
<p>Breadcrumbs provide the ability to track activity within your app.</p>
</blockquote>
<pre><code class="cpp">static void setAsyncBreadcrumbMode ( bool writeAsync ) ;
</code></pre>

<blockquote>
<p>By default, breadcrumbs are flushed to disk immediately when written.
This is by design - in order to provide an accurate record of everything
that happened up until the point your app crashed.</p>
</blockquote>
<pre><code class="cpp">static void updateLocation ( double latitude , double longitude ) ;
</code></pre>

<blockquote>
<p>Inform Apteligent of the device's most recent location for use with
performance monitoring.</p>
</blockquote>
<pre><code class="cpp">static bool logNetworkRequest ( const std::string &amp; method ,
                                const std::string &amp; urlString ,
                                long latency ,
                                long bytesRead ,
                                long bytesSent ,
                                long responseCode ) ;
</code></pre>

<blockquote>
<p>Logging endpoints is a way of manually logging custom network library
network access to URL's which fall outside Apteligent's monitoring
of NSURLConnection and ASIHTTPRequest method calls.</p>
</blockquote>
<pre><code class="cpp">static void setOptOutStatus ( bool status ) ;
</code></pre>

<blockquote>
<p>If you wish to offer your users the ability to opt out of Apteligent
crash reporting, you can set the OptOutStatus to YES. If you do so, any
pending crash reports will be purged.</p>
</blockquote>
<pre><code class="cpp">static bool getOptOutStatus ( ) ;
</code></pre>

<blockquote>
<p>Retrieve current opt out status.</p>
</blockquote>
<pre><code class="cpp">static void setMaxOfflineCrashReports ( int max ) ;
</code></pre>

<blockquote>
<p>Set the maximum number of crash reports that will be stored on
the local device if the device does not have internet connectivity. If
more than |maxOfflineCrashReports| crashes occur, the oldest crash will be
overwritten. Decreasing the value of this setting will not delete
any offline crash reports. Unsent crash reports will be kept until they are
successfully transmitted to Apteligent, hence there may be more than
|maxOfflineCrashReports| stored on the device for a short period of time.</p>
</blockquote>
<pre><code class="cpp">static int maxOfflineCrashReports ( ) ;
</code></pre>

<blockquote>
<p>Get the maximum number of Apteligent crash reports that will be stored on
the local device if the device does not have internet connectivity.</p>
</blockquote>
<pre><code class="cpp">static std::string getUserUUID ( ) ;
</code></pre>

<blockquote>
<p>Get the Apteligent generated unique identifier for this device.</p>
</blockquote>
<pre><code class="cpp">static void setUsername ( const std::string &amp; username ) ;
</code></pre>

<blockquote>
<p>Associate a username string with the device's Apteligent UUID. This will
send the association to Apteligent's back end.</p>
</blockquote>
<pre><code class="cpp">static void setValueforKey ( const std::string &amp; value ,
                             const std::string &amp; key ) ;
</code></pre>

<blockquote>
<p>Associate an arbitrary key/value pair with the device's Apteligent UUID.</p>
</blockquote>
<pre><code class="cpp">static bool didCrashOnLastLoad ( ) ;
</code></pre>

<blockquote>
<p>Did the application crash on the previous load?</p>
</blockquote>
<pre><code class="cpp">static void beginUserflow ( const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>Init and begin a userflow with a default value.</p>
</blockquote>
<pre><code class="cpp">static void beginUserflow ( const std::string &amp; name , int value ) ;
</code></pre>

<blockquote>
<p>Init and begin a userflow with an input value.</p>
</blockquote>
<pre><code class="cpp">static void cancelUserflow ( const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>Cancel a userflow as if it never existed.</p>
</blockquote>
<pre><code class="cpp">static void endUserflow ( const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>End an already begun userflow successfully.</p>
</blockquote>
<pre><code class="cpp">static void failUserflow ( const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>End an already begun userflow as a failure.</p>
</blockquote>
<pre><code class="cpp">static int valueForUserflow ( const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>Get the currency cents value of a userflow.</p>
</blockquote>
<pre><code class="cpp">static void setValueforUserflow ( int value , const std::string &amp; name ) ;
</code></pre>

<blockquote>
<p>Set the currency cents value of a userflow.</p>
</blockquote>
<pre><code class="cpp">static void sendAppLoadData ( ) ;
</code></pre>

<blockquote>
<p>Tell Apteligent to send app load event.
By default, Apteligent will send app load event automatically when your app is started
However, if you set delaySendingAppLoad flag to YES on config, you can call this method to
manually send app load event.</p>
</blockquote>
<pre><code class="cpp">static void setLoggingLevel ( int loggingLevel ) ;
</code></pre>

<blockquote>
<p>Set the logging level to tune the verbosity of Apteligent log messages.</p>
</blockquote>
<h3 id="listeners">Listeners</h3>
<pre><code class="cpp">void onCrashOnLastLoad ( ) {
</code></pre>

<blockquote>
<p>Notifies the delegate that the app has crash last time.</p>
</blockquote>
<h2 id="_14">手动集成</h2>
<p>如果 <em>SDKBOX 安装器</em> 安装插件失败了，那么需要手动集成插件.如果安装器安装插件成功了,那么不需要，也没必要,按文档再手动集成一次.</p>
<p>下面列出的的步骤一般很少用到.如果你按下面的步骤完成了集成，请在完成集成后，再按步骤检查一次.</p>
<h2 id="ios">iOS 平台手动集成</h2>
<p>拖拽下列 framework 从 <code>Apteligent</code> 插件包的 <strong>plugins/ios</strong> 目录到您的 Xcode 工程中，在添加 frameworks 的时候，请勾选 <code>Copy items if needed</code> 。</p>
<blockquote>
<p>sdkbox.framework</p>
<p>PluginApteligent.framework</p>
<p>Crittercism.framework</p>
</blockquote>
<p>如果您没有添加下面这些系统库，您有需要添加它们：</p>
<blockquote>
<p>SystemConfiguration.framework</p>
<p>CoreLocation.framework</p>
</blockquote>
<h2 id="android">Android 手动集成</h2>
<p>SDKBox 支持三种 <strong>Android</strong> 工程, <strong>command-line</strong>, <strong>eclipse</strong> 和 <strong>Android Studio</strong>.</p>
<ul>
<li><strong>command-line</strong> 和 <strong>eclipse</strong> 类型的项目, <code>&lt;project_root&gt;</code> 指代 <code>proj.android</code> .</li>
<li><strong>Android Studio</strong> 类型的项目, <code>&lt;project_root&gt;</code> 指代 <code>proj.android-studio</code> .</li>
</ul>
<h3 id="_15">拷贝文件</h3>
<p>从插件安装包中的 <code>plugin/android/libs</code> 目录拷贝所有文件到您的工程的 <strong>proj.android/libs</strong> 目录。</p>
<h4 id="jni">拷贝 jni 库</h4>
<p>从 <code>plugin/android/jni/</code> 拷贝并覆盖 <code>&lt;your_project_root&gt;/jni/</code> 目录.</p>
<blockquote>
<p>注意: sdkbox 默认使用 <code>gnustl</code> 链接, 如果您的项目使用 <code>c++_static</code> 链接, 请把
<code>&lt;project_root&gt;/jni/&lt;plugin_name&gt;/libs</code> 目录下的文件夹替换成 <code>&lt;project_root&gt;/jni/&lt;plugin_name&gt;/libs_c++_static</code> 里面的</p>
</blockquote>
<h3 id="androidmanifestxml">编辑 <code>AndroidManifest.xml</code></h3>
<p>在标签 <strong>application tag</strong> 上添加下列权限：</p>
<pre><code class="xml">    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;/&gt;
    &lt;uses-permission android:name=&quot;android.permission.GET_TASKS&quot;/&gt;
</code></pre>

<h3 id="androidmk">编辑 <code>Android.mk</code></h3>
<p>编辑 <code>proj.android/jni/Android.mk</code>：</p>
<p>为 <strong>LOCAL_WHOLE_STATIC_LIBRARIES</strong> 添加额外的库：</p>
<pre><code>LOCAL_WHOLE_STATIC_LIBRARIES += android_native_app_glue
LOCAL_LDLIBS += -landroid
LOCAL_LDLIBS += -llog
LOCAL_WHOLE_STATIC_LIBRARIES += PluginApteligent
LOCAL_WHOLE_STATIC_LIBRARIES += sdkbox
</code></pre>

<p>在所有 <strong>import-module</strong> 语句之前添加一条 call 语句：</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
</code></pre>

<p>在最后添加额外的 <strong>import-module</strong> 语句：</p>
<pre><code>$(call import-module, ./sdkbox)
$(call import-module, ./pluginapteligent)
</code></pre>

<p>这意味着您的语句顺序看起来像是这样：</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
$(call import-module, ./sdkbox)
$(call import-module, ./pluginapteligent)
</code></pre>

<h3 id="applicationmk">编辑 <code>Application.mk</code></h3>
<p>编辑 <code>proj.android/jni/Application.mk</code>：</p>
<p>Add <strong>APP_PATFORM</strong> version requirements:</p>
<pre><code>APP_PLATFORM := android-15
</code></pre>

<h3 id="yourgamenamejava">修改 <code>&lt;YourGameName&gt;.java</code></h3>
<ul>
<li>修改 <code>proj.android/src/&lt;package identifier&gt;/&lt;YourGameName&gt;.java</code> 文件，导入如下包：</li>
</ul>
<pre><code class="java">import android.content.Intent;
import com.sdkbox.plugin.SDKBox;
</code></pre>

<ul>
<li>然后，修改您的类 <code>onCreate(final Bundle savedInstanceState)</code> 函数，添加一个调用语句 <code>SDKBox.init(this)</code> 。如下：</li>
</ul>
<pre><code class="java">protected void onCreate(Bundle savedInstanceState){
  super.onCreate(savedInstanceState);
  SDKBox.init(this);
}
</code></pre>

<ul>
<li>
<p>最后, 我需要提供合适的 <strong>overrides</strong> 方法的代码。这里有一些约定如下。</p>
<ul>
<li>
<p>如果这个被列出的方法没有在 <code>SDKBox</code> 中定义，那么<strong>定义它</strong>。</p>
</li>
<li>
<p>如果这个被列出的方法已经被定义在 <code>SDKBox</code> 中，那么请调用这个在 <code>SDKBox</code> 中的<strong>同名方法</strong>。</p>
</li>
</ul>
</li>
</ul>
<pre><code class="java">    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
          if(!SDKBox.onActivityResult(requestCode, resultCode, data)) {
            super.onActivityResult(requestCode, resultCode, data);
          }
    }
    @Override
    protected void onStart() {
          super.onStart();
          SDKBox.onStart();
    }
    @Override
    protected void onStop() {
          super.onStop();
          SDKBox.onStop();
    }
    @Override
    protected void onResume() {
          super.onResume();
          SDKBox.onResume();
    }
    @Override
    protected void onPause() {
          super.onPause();
          SDKBox.onPause();
    }
    @Override
    public void onBackPressed() {
          if(!SDKBox.onBackPressed()) {
            super.onBackPressed();
          }
    }
</code></pre>

<h2 id="proguard-release">使用 Proguard （release模式下可选）</h2>
<ul>
<li>编辑 <code>project.properties</code> 文件， 指定一个 <code>Proguard</code> 配置文件。比如：</li>
</ul>
<pre><code>proguard.config=proguard.cfg
</code></pre>

<ul>
<li>编辑这个配置文件，加入如下内容：</li>
</ul>
<pre><code># If your project uses WebView with JS, uncomment the following
# and specify the fully qualified class name to the JavaScript interface
# class:
#-keepclassmembers class fqcn.of.javascript.interface.for.webview {
#   public *;
#}

# cocos2d-x
-keep public class org.cocos2dx.** { *; }
-dontwarn org.cocos2dx.**
-keep public class com.chukong.** { *; }
-dontwarn com.chukong.**

# google play service
-keep public class com.google.android.gms.** { public *; }
-dontwarn com.google.android.gms.**

-keep class * extends java.util.ListResourceBundle {
    protected Object[][] getContents();
}

-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
    public static final *** NULL;
}

-keepnames @com.google.android.gms.common.annotation.KeepName class *
-keepclassmembernames class * {
    @com.google.android.gms.common.annotation.KeepName *;
}

-keepnames class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

#sdkbox
-keep public class com.sdkbox.** { *; }
-dontwarn com.sdkbox.**

# apteligent
-keep public class android.webkit.** { *; }
-dontwarn android.webkit.**
-keep public class com.crittercism.**
-keepclassmembers public class com.crittercism.*
{
    *;
}

</code></pre>

<p><strong>Note:</strong> Proguard 只能工作在 <strong>Release</strong> 模式下 （比如： <code>cocos run -m release</code>） debug 模式下不会触发 Proguard 。</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>


    </body>
</html>
